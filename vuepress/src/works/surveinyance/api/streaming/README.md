# ストリーミング API

## 概要

ストリーミング API を用いることで、リアルタイムに様々な情報を受け取ったり、様々な操作を行うことができます。

## ストリームに接続する

ストリーミング API を利用するには、まず Surveinyance が動作しているサーバに WebSocket で接続する必要があります。
以下の形式の URL に WebSocket 接続します:

```
wss://{host}/streaming?token={token}
```

ここで、

- `{host}`は Surveinyance が動作しているサーバの URL です。
- `{token}`は Surveinyance で発行したトークンです。

::: warning
アクセストークンは必須です。存在しない場合は 403 エラーが返されます。
:::

ストリームに接続すると、後述の購読を行うことはできますが、この段階ではサーバーメトリクス等のデータを受け取ることはできません。そのようなイベントを受診するには、ストリーム上で後述するチャンネルに接続する必要があります。

**ストリーム上のやりとりは全て JSON で行われます。**

## チャンネル

Surveinyance のストリーミング API には、チャンネルという概念があります。これは、送受信する情報を分離するための仕組みです。ストリーム上でチャンネルに接続することで、さまざまな情報を受け取ったり情報を送信したりすることができるようになります。

::: tip
ひとつのストリーム接続上で、同時に複数のチャンネルに接続することができます。
:::

以下では、チャンネルの使用方法を説明します。どのようなチャンネルがあるかは、[チャンネル一覧](/works/surveinyance/api/streaming/channels.html)を参照してください。

## チャンネルに接続する
チャンネルに接続するには、次のようなデータをJSONでストリームに送信します。

## チャンネルに向けてメッセージを送信する

## チャンネルから切断する